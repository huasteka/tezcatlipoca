var $=Object.defineProperty,w=Object.defineProperties;var y=Object.getOwnPropertyDescriptors;var h=Object.getOwnPropertySymbols;var m=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable;var P=(e,a,s)=>a in e?$(e,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[a]=s,t=(e,a)=>{for(var s in a||(a={}))m.call(a,s)&&P(e,s,a[s]);if(h)for(var s of h(a))f.call(a,s)&&P(e,s,a[s]);return e},i=(e,a)=>w(e,y(a));var I=(e,a)=>{var s={};for(var c in e)m.call(e,c)&&a.indexOf(c)<0&&(s[c]=e[c]);if(e!=null&&h)for(var c of h(e))a.indexOf(c)<0&&f.call(e,c)&&(s[c]=e[c]);return s};import{d as b}from"./vendor.2c85bd1e.js";import{s as g,r as v,f as L,e as R,i as T}from"./index.cefb1522.js";import{u as k}from"./index.917c111f.js";const D=k(),x=D.bearerToken;g(()=>D.logout());const r=T(x),A=b({id:"huitzilopochtli-purchases",state:()=>({purchaseList:{},purchaseIncludedData:{},selectedPurchase:null}),getters:{purchases:e=>Object.values(e.purchaseList),purchaseWithRelationships:e=>{if(e.selectedPurchase){const a=e.selectedPurchase.merchandisesPurchased.map(s=>{var n,o,l;const c=e.purchaseIncludedData.merchandises_purchased[s],u=(n=c.relationships.supplier.data.slice().pop())==null?void 0:n.id,d=(o=c.relationships.merchandise.data.slice().pop())==null?void 0:o.id,p=e.purchaseIncludedData.merchandises[d],S=(l=p.relationships.product.data.slice().pop())==null?void 0:l.id;return i(t({},c),{supplier:t({},e.purchaseIncludedData.suppliers[u]),merchandise:t({},p),product:t({},e.purchaseIncludedData.products[S])})});return i(t({},e.selectedPurchase),{merchandises_purchased:a})}return null}},actions:{async fetchPurchaseList(e=null){const{data:a}=await r.fetchPurchaseList(e);this.$patch(s=>{s.purchaseList=v(a.data),s.purchaseIncludedData=L(a.included)})},async fetchOnePurchase(e){if(this.purchaseList[e]){this.$patch(s=>s.selectedPurchase=this.purchaseList[e]);return}const{data:a}=await r.fetchPurchase(e);this.$patch(s=>{s.selectedPurchase=t(t({id:a.data.id},a.data.attributes),R(a.data.relationships)),s.purchaseIncludedData=L(a.included)})},async createPurchase(e){const{data:a}=await r.createPurchase(e);this.$patch(s=>s.purchaseList[a.data.id]=a.data)},async updatePurchase(s){var c=s,{id:e}=c,a=I(c,["id"]);const u=t({id:e},a);await r.updatePurchase(u),this.$patch(d=>d.purchaseList[e]=u)},async deletePurchase(e){await r.deletePurchase(e),this.$patch(a=>delete a.purchaseList[e])}}});export{A as u};
