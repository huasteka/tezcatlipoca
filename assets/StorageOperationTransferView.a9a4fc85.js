import{u as A,A as B}from"./Alert.8d9247e8.js";import{u as $}from"./storage.be6d3a79.js";import{_ as U,N as C}from"./index.917c111f.js";import{e as F,r as D,f as u,L as I,M as O,u as o,o as i,c as g,w as t,h as a,g as b,W as T,i as v,t as m,l as S,F as y,s as E}from"./vendor.2c85bd1e.js";import"./interceptor.bb9bfcba.js";const M={from_storage_id:[{required:!0,message:"Please, select the source storage",trigger:"blur"}],to_storage_id:[{required:!0,message:"Please, select the target storage",trigger:"blur"}],item_id:[{required:!0,message:"Please, select an item",trigger:"blur"}],quantity:[{required:!0,message:"Please, input the quantity",trigger:"blur"},{type:"number",min:1,message:"Must be greater than zero",trigger:"blur"}]};const R=S("Submit"),z={emits:["submit"],setup(k,{emit:V}){const d=$(),s=F({isLoading:!0,storageList:[],itemList:[]});Promise.all([d.fetchStorageList(),d.fetchItemList()]).then(()=>{s.isLoading=!1,s.storageList=d.storages,s.itemList=d.items});const _=D(),r=F({from_storage_id:null,to_storage_id:null,item_id:null,quantity:0}),c=F(M),f=n=>{!n||n.validate(l=>{if(!l)return!1;V("submit",{model:n.model,clearForm:n.resetFields})})};return(n,l)=>{const L=u("el-tag"),h=u("el-option"),q=u("el-select"),p=u("el-form-item"),x=u("el-input-number"),w=u("el-button"),N=u("el-form"),P=I("loading");return O((i(),g(N,{"label-width":"130px",ref_key:"createStorageTransferFormRef",ref:_,model:o(r),rules:o(c)},{default:t(()=>[a(p,{label:"Source storage",prop:"from_storage_id"},{default:t(()=>[a(q,{class:"small-form-input",placeholder:"Select a source storage",modelValue:o(r).from_storage_id,"onUpdate:modelValue":l[0]||(l[0]=e=>o(r).from_storage_id=e)},{default:t(()=>[(i(!0),b(y,null,T(o(s).storageList,e=>(i(),g(h,{key:e.id,label:`${e.name} (${e.code})`,value:e.id},{default:t(()=>[v("span",null,m(e.name),1),a(L,{class:"select-option-icon-position"},{default:t(()=>[S(m(e.code),1)]),_:2},1024)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(p,{label:"Target storage",prop:"to_storage_id"},{default:t(()=>[a(q,{class:"small-form-input",placeholder:"Select a target storage",modelValue:o(r).to_storage_id,"onUpdate:modelValue":l[1]||(l[1]=e=>o(r).to_storage_id=e)},{default:t(()=>[(i(!0),b(y,null,T(o(s).storageList,e=>(i(),g(h,{key:e.id,label:`${e.name} (${e.code})`,value:e.id},{default:t(()=>[v("span",null,m(e.name),1),a(L,{class:"select-option-icon-position"},{default:t(()=>[S(m(e.code),1)]),_:2},1024)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(p,{label:"Item",prop:"item_id"},{default:t(()=>[a(q,{placeholder:"Select an item",modelValue:o(r).item_id,"onUpdate:modelValue":l[2]||(l[2]=e=>o(r).item_id=e)},{default:t(()=>[(i(!0),b(y,null,T(o(s).itemList,e=>(i(),g(h,{key:e.id,label:`${e.name} (${e.code})`,value:e.id},{default:t(()=>[v("span",null,m(e.name),1),a(L,{class:"select-option-icon-position"},{default:t(()=>[S(m(e.code),1)]),_:2},1024)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(p,{label:"Quantity",prop:"quantity"},{default:t(()=>[a(x,{class:"small-form-input",min:0,modelValue:o(r).quantity,"onUpdate:modelValue":l[3]||(l[3]=e=>o(r).quantity=e)},null,8,["modelValue"])]),_:1}),a(p,null,{default:t(()=>[a(w,{type:"primary",icon:o(E),onClick:l[4]||(l[4]=e=>f(_.value))},{default:t(()=>[R]),_:1},8,["icon"])]),_:1})]),_:1},8,["model","rules"])),[[P,o(s).isLoading]])}}};var Q=U(z,[["__scopeId","data-v-50a9bdb4"]]);const W=v("h2",null,"Storage Transfer",-1),X={setup(k){const V=A(),d=$(),s=({model:_,clearForm:r})=>{d.createTransferOperation(_).then(()=>{C.notifySuccess("A transfer was issued between the source and target storages"),r()}).catch(({response:c})=>{var f,n;return(n=(f=c.data)==null?void 0:f.errors)==null?void 0:n.forEach(l=>V.error(l.title))})};return(_,r)=>(i(),b(y,null,[W,a(B),a(Q,{onSubmit:r[0]||(r[0]=c=>s(c))})],64))}};export{X as default};
