var _=Object.defineProperty;var o=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,g=Object.prototype.propertyIsEnumerable;var h=(s,t,e)=>t in s?_(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,v=(s,t)=>{for(var e in t||(t={}))S.call(t,e)&&h(s,e,t[e]);if(o)for(var e of o(t))g.call(t,e)&&h(s,e,t[e]);return s};var y=(s,t)=>{var e={};for(var r in s)S.call(s,r)&&t.indexOf(r)<0&&(e[r]=s[r]);if(s!=null&&o)for(var r of o(s))t.indexOf(r)<0&&g.call(s,r)&&(e[r]=s[r]);return e};import{S as b}from"./SalesSupplierForm.704e52a2.js";import{N as l,r as L}from"./index.917c111f.js";import{u as k}from"./supplier.bb90ccb0.js";import{e as F,L as B,o as d,g as c,M as E,u as m,h as V,Q as x,F as D,i as I}from"./vendor.2c85bd1e.js";import"./index.cefb1522.js";import"./interceptor.bb9bfcba.js";const M=I("h2",null,"Update supplier",-1),w={key:0},q={props:{supplierId:Number},setup(s){const t=s,e=k(),r=F({supplier:null,isLoading:!0});e.fetchOneSupplier(t.supplierId).then(()=>{r.isLoading=!1,r.supplier=e.supplierWithRelationships});const C=f=>{var a=f,{contacts:u}=a,p=y(a,["contacts"]);r.isLoading=!0,e.updateSupplier(v({},p)).then(n=>{if(l.notifySuccess("Supplier updated"),u.length===0){L.push({path:"/dashboard/sales-management/suppliers"});return}const N=u.map(i=>i.deletionMarked===!0?e.deleteSupplierContact(n,i.id):i.id?e.updateSupplierContact(n,i):e.createSupplierContact(n,i));Promise.all(N).then(()=>{l.notifySuccess("Supplier contact updated"),L.push({path:"/dashboard/sales-management/suppliers"})}).catch(()=>l.notifyError("Could not update supplier contacts")).finally(()=>r.isLoading=!1)}).catch(()=>l.notifyError("Could not update supplier")).finally(()=>r.isLoading=!1)};return(u,p)=>{const f=B("loading");return d(),c(D,null,[M,E((d(),c("div",null,[m(r).supplier!==null?(d(),c("div",w,[V(b,{supplier:m(r).supplier,onSubmit:p[0]||(p[0]=a=>C(a))},null,8,["supplier"])])):x("",!0)])),[[f,m(r).isLoading]])],64)}}};export{q as default};
