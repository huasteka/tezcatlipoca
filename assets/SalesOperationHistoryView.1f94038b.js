import{C as k}from"./currencyFormatter.f80cc1e2.js";import{u as U}from"./purchase.8c476328.js";import{_ as $}from"./index.917c111f.js";import{e as O,f as a,L as E,o as _,c as v,w as o,i as T,h as t,M as x,u as i,l as b,g as I,F as M,W as Y,Q as D,p as Z,k as j,a1 as J,t as P,Y as K,Z as X,T as ee}from"./vendor.2c85bd1e.js";import{u as H}from"./sale.598e92ad.js";import"./index.cefb1522.js";import"./interceptor.bb9bfcba.js";const te={class:"dialog-footer"},se=b("Close"),oe={props:{purchaseId:Number,isVisible:Boolean},emits:["toggle"],setup(m,{emit:f}){const h=m,n=U(),e=O({isLoading:!0,isVisible:h.isVisible,dataGrid:{}});n.fetchOnePurchase(h.purchaseId).then(()=>{e.isLoading=!1,e.dataGrid=n.purchaseWithRelationships});const g=(c=0)=>k.format(c),V=c=>g(c.purchase_price),y=()=>{e.isVisible=!e.isVisible,f("toggle",e.isVisible)},w=({data:c})=>{const l=c.reduce((r,p)=>r+=p.purchase_price*p.quantity,0);return["Total","",g(l),""]};return(c,l)=>{const r=a("el-table-column"),p=a("el-table"),S=a("el-button"),C=a("el-dialog"),u=E("loading");return _(),v(C,{"destroy-on-close":"",modelValue:i(e).isVisible,"onUpdate:modelValue":l[1]||(l[1]=s=>i(e).isVisible=s),title:"Purchase Order Detail",width:"75%",onClose:l[2]||(l[2]=s=>y())},{footer:o(()=>[T("div",te,[t(S,{onClick:l[0]||(l[0]=s=>y())},{default:o(()=>[se]),_:1})])]),default:o(()=>{var s;return[x((_(),v(p,{"show-summary":"",data:(s=i(e).dataGrid)==null?void 0:s.merchandises_purchased,"summary-method":w},{default:o(()=>[t(r,{property:"supplier.name",label:"Supplier",width:"250"}),t(r,{property:"product.name",label:"Product",width:"250"}),t(r,{property:"purchase_price",label:"Purchase Price",width:"150","class-name":"table-column-text-align-right",formatter:V}),t(r,{property:"quantity",label:"Quantity",width:"100","class-name":"table-column-text-align-right"})]),_:1},8,["data"])),[[u,i(e).isLoading]])]}),_:1},8,["modelValue"])}}};var le=$(oe,[["__scopeId","data-v-502461b1"]]);const ie={class:"dialog-footer"},ae=b("Close"),ne={props:{saleId:Number,isVisible:Boolean},emits:["toggle"],setup(m,{emit:f}){const h=m,n=H(),e=O({isLoading:!0,isVisible:h.isVisible,dataGrid:{}});n.fetchOneSale(h.saleId).then(()=>{e.isLoading=!1,e.dataGrid=n.saleWithRelationships});const g=(c=0)=>k.format(c),V=c=>g(c.retail_price),y=()=>{e.isVisible=!e.isVisible,f("toggle",e.isVisible)},w=({data:c})=>{const l=c.reduce((r,p)=>r+=p.retail_price*p.quantity,0);return["Total","",g(l),""]};return(c,l)=>{const r=a("el-table-column"),p=a("el-table"),S=a("el-button"),C=a("el-dialog"),u=E("loading");return _(),v(C,{"destroy-on-close":"",modelValue:i(e).isVisible,"onUpdate:modelValue":l[1]||(l[1]=s=>i(e).isVisible=s),title:"Sale Order Detail",width:"75%",onClose:l[2]||(l[2]=s=>y())},{footer:o(()=>[T("div",ie,[t(S,{onClick:l[0]||(l[0]=s=>y())},{default:o(()=>[ae]),_:1})])]),default:o(()=>{var s;return[x((_(),v(p,{"show-summary":"",data:(s=i(e).dataGrid)==null?void 0:s.merchandises_sold,"summary-method":w},{default:o(()=>[t(r,{property:"client.name",label:"Client",width:"250"}),t(r,{property:"product.name",label:"Product",width:"250"}),t(r,{property:"retail_price",label:"Retail Price",width:"150","header-align":"center",align:"right",formatter:V}),t(r,{property:"quantity",label:"Quantity",width:"100","header-align":"center",align:"right"})]),_:1},8,["data"])),[[u,i(e).isLoading]])]}),_:1},8,["modelValue"])}}};const re=m=>(Z("data-v-5637f797"),m=m(),j(),m),de=re(()=>T("h2",null,"Sales Operations History",-1)),ce=b("Details"),ue={key:0},pe={key:1},_e={setup(m){const f=H(),h=U(),n={SALES:"sales",PURCHASES:"purchases"},e=O({isLoading:!0,type:n.SALES,history:[],selectionId:null,isModalOpen:!1}),g=u=>{switch(e.isLoading=!0,u){case n.SALES:f.fetchSaleList().then(()=>{e.isLoading=!1,e.history=f.sales});break;case n.PURCHASES:h.fetchPurchaseList().then(()=>{e.isLoading=!1,e.history=h.purchases});break;default:e.isLoading=!1,e.history=[];break}};g(e.type);const V=()=>{switch(e.type){case n.SALES:return"Sale";case n.PURCHASES:return"Purchase";default:return"Unknown"}},y=()=>{switch(e.type){case n.SALES:return ee;case n.PURCHASES:return X;default:return K}},w=()=>{switch(e.type){case n.SALES:return"success";case n.PURCHASES:return"danger";default:return"warning"}},c=()=>e.type===n.SALES,l=()=>e.type===n.PURCHASES,r=(u=0)=>k.format(u),p=u=>{e.selectionId=parseInt(u.id,10),e.isModalOpen=!0},S=u=>{e.selectionId=null,e.isModalOpen=u},C=u=>{g(u)};return(u,s)=>{const A=a("el-option"),R=a("el-select"),G=a("el-form-item"),N=a("el-form"),B=a("el-divider"),q=a("el-button"),L=a("el-descriptions-item"),F=a("el-descriptions"),Q=a("el-timeline-item"),W=a("el-timeline"),z=E("loading");return _(),I(M,null,[de,t(N,{inline:!0},{default:o(()=>[t(G,null,{default:o(()=>[t(R,{placeholder:"Select operation type",modelValue:i(e).type,"onUpdate:modelValue":s[0]||(s[0]=d=>i(e).type=d),onChange:s[1]||(s[1]=d=>C(d))},{default:o(()=>[t(A,{label:"Sales",value:"sales"}),t(A,{label:"Purchases",value:"purchases"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(B),x((_(),v(W,null,{default:o(()=>[(_(!0),I(M,null,Y(i(e).history,d=>(_(),v(Q,{size:"large",key:d.id,icon:y(),type:w(),timestamp:new Date(d.created_at).toUTCString()},{default:o(()=>[t(F,{border:"",class:"timeline-description-max-width",column:3,title:V()},{extra:o(()=>[t(q,{plain:"",round:"",type:"primary",icon:i(J),onClick:me=>p(d)},{default:o(()=>[ce]),_:2},1032,["icon","onClick"])]),default:o(()=>[t(L,{label:"Code"},{default:o(()=>[b(P(d.code||"-"),1)]),_:2},1024),t(L,{label:"Description",span:2},{default:o(()=>[b(P(d.description||"-"),1)]),_:2},1024),t(L,{label:"Gross value"},{default:o(()=>[b(P(r(d.grossValue)),1)]),_:2},1024),t(L,{label:"Discount"},{default:o(()=>[b(P(r(d.discount)),1)]),_:2},1024),t(L,{label:"Net value"},{default:o(()=>[b(P(r(d.net_value)),1)]),_:2},1024)]),_:2},1032,["title"])]),_:2},1032,["icon","type","timestamp"]))),128))]),_:1})),[[z,i(e).isLoading]]),i(e).selectionId!==null&&l()?(_(),I("div",ue,[t(le,{purchaseId:i(e).selectionId,isVisible:i(e).isModalOpen,onToggle:s[2]||(s[2]=d=>S(d))},null,8,["purchaseId","isVisible"])])):D("",!0),i(e).selectionId!==null&&c()?(_(),I("div",pe,[t(ne,{saleId:i(e).selectionId,isVisible:i(e).isModalOpen,onToggle:s[3]||(s[3]=d=>S(d))},null,8,["saleId","isVisible"])])):D("",!0)],64)}}};var Ve=$(_e,[["__scopeId","data-v-5637f797"]]);export{Ve as default};
